<!DOCTYPE html>
<html>
  <head>
    <link
      rel="stylesheet"
      crossorigin="anonymous"
      href="https://cdn.jsdelivr.net/npm/@finos/perspective-viewer/dist/css/themes.css"
    />
    <style>
      perspective-viewer {
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
      }
    </style>
  </head>
  <body>
    <perspective-viewer></perspective-viewer>
  </body>

  <script type="module">
    import "https://cdn.jsdelivr.net/npm/@finos/perspective-viewer/dist/cdn/perspective-viewer.js";
    import "https://cdn.jsdelivr.net/npm/@finos/perspective-viewer-datagrid/dist/cdn/perspective-viewer-datagrid.js";
    import perspective from "https://cdn.jsdelivr.net/npm/@finos/perspective/dist/cdn/perspective.js";

    const worker = await perspective.worker();
    const viewer = document.getElementsByTagName("perspective-viewer")[0];

    const table = await worker.table(
      {
        Field_A: "string",
        Field_B: "float",
        Field_C: "string",
        index: "string",
      },
      { index: "index" }
    );

    await viewer.load(table);
    await viewer.restore({
      columns: ["Field_B"],
      split_by: [],
      aggregates: { Field_B: "sum" },
      sort: [
        ["Field_C", "asc"],
        ["Field_B", "desc"],
      ],
      group_by: ["Field_A"],
      filter: [["Field_C", "in", ["2025/07/08"]]],
    });

    await table.update(await fetch("data.json").then((res) => res.json()));
  </script>
</html>
